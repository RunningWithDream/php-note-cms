{extend name="admin/common/base"/}
{block name="content"}
<div class="x-body">
    <form action="" method="post" class="layui-form layui-form-pane">
        <div class="layui-form-item">
            <label for="rolename" class="layui-form-label">角色名
            </label>
            <div class="layui-input-block">
                <input type="text" id="rolename" name="rolename" required="" lay-verify="required"
                       autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">
                拥有权限
            </label>
            <table class="layui-table layui-input-block">
                <tbody>
                <tr>
                    <td>
                        <input type="checkbox" name="node[]" lay-skin="primary" lay-filter="father" title="用户管理"
                               value="0">
                    </td>
                    <td>
                        <div class="layui-input-block">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="1" title="用户停用">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="2" title="用户删除">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="3" title="用户修改">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="4" title="用户改密">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="5" title="用户列表">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="6" title="用户改密">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="7" title="用户列表">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="8" title="用户改密">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="9" title="用户列表">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <input name="node[]" lay-skin="primary" type="checkbox" value="20" title="文章管理"
                               lay-filter="father">
                    </td>
                    <td>
                        <div class="layui-input-block">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="21" title="文章添加">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="22" title="文章删除">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="23" title="文章修改">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="24" title="文章改密">
                            <input name="node[]" lay-skin="primary" type="checkbox" value="25" title="文章列表">
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="layui-form-item layui-form-text">
            <label for="desc" class="layui-form-label">
                描述
            </label>
            <div class="layui-input-block">
                <textarea placeholder="请输入内容" id="desc" name="desc" class="layui-textarea"></textarea>
            </div>
        </div>
        <div class="layui-form-item">
            <button class="layui-btn" lay-submit="" lay-filter="add">增加</button>
        </div>
    </form>
</div>
{/block}
{block name="script"}
<script>
    layui.use(['form', 'layer'], function () {
        $ = layui.jquery;
        var form = layui.form
            , layer = layui.layer;


        //监听提交
        form.on('submit(add)', function (data) {
            console.log(data);
            //发异步，把数据提交给php
            $.post('./role-save', data.field, function (rdata) {
                console.log(rdata);
                if (rdata.code == 0) {

                    layer.alert(rdata.msg, {icon: 6}, function () {
                        // 获得frame索引
                        var index = parent.layer.getFrameIndex(window.name);
                        //关闭当前frame
                        parent.layer.close(index);
                    });
                }

            });


            return false;
        });


        form.on('checkbox(father)', function (data) {

            if (data.elem.checked) {
                $(data.elem).parent().siblings('td').find('input').prop("checked", true);
                form.render();
            } else {
                $(data.elem).parent().siblings('td').find('input').prop("checked", false);
                form.render();
            }
        });


    });
</script>
{/block}