{extend name="admin/common/base"/}
{block name="content"}
<div class="x-nav">
      <span class="layui-breadcrumb">
        <a href="">首页</a>
        <a href="">演示</a>
        <a>
          <cite>导航元素</cite></a>
      </span>
    <a class="layui-btn layui-btn-small x-right"
       style="height: 30px;line-height: 30px;margin-top: 5px;text-align: center;"
       href="javascript:location.replace(location.href);" title="刷新">
        <i class="layui-icon layui-icon-refresh"></i>
    </a>
</div>
<div class="x-body">
    <div class="layui-row">
        <form class="layui-form layui-col-md12 x-so">
            <input class="layui-input" placeholder="开始日" name="start" id="start" autocomplete="off">
            <input class="layui-input" placeholder="截止日" name="end" id="end" autocomplete="off">
            <input type="text" name="username" placeholder="请输入用户名" autocomplete="off" class="layui-input">
            <button class="layui-btn" lay-submit="" lay-filter="sreach"><i class="layui-icon">&#xe615;</i></button>
        </form>
    </div>
    <xblock>
        <button class="layui-btn layui-btn-danger" onclick="delAll()"><i class="layui-icon"></i>批量删除</button>
        <button class="layui-btn" onclick="x_admin_show('添加用户','./admin-add.html')"><i class="layui-icon "></i>添加
        </button>
    </xblock>


    <table id="list" lay-filter="users-table" class="layui-table"></table>

    <script type="text/html" id="oprate-bar">
        <div class="layui-btn-group">
            <a class="layui-btn layui-btn-xs layui-btn-primary" lay-event="edit">编辑</a>
            <a class="layui-btn layui-btn-xs layui-btn-danger " lay-event="del">删除</a>
        </div>
    </script>

    <script type="text/html" id="status-bar">
        <div class="layui-inline layui-form">
            <input type="checkbox" lay-skin="switch" lay-text="启用|禁用" data-id="{{d.id}}" lay-filter="status">
        </div>
    </script>


</div>
{/block}
{block name="script"}
<script>
    layui.use(['laydate', 'form', 'table'], function () {
        var laydate = layui.laydate, form = layui.form, $ = layui.jquery, table = layui.table;

        table.render({
            elem: '#list'
            , url: '{:url("admin/admin/index")}' //数据接口
            , page: {
                layout: ['prev', 'page', 'next', 'count'] //开启分页
            }
            , cols: [[ //表头
                {type: 'checkbox'}
                , {field: 'id', title: 'ID', width: 50}
                , {field: 'username', title: '登录名', width: 100}
                , {field: 'phone', title: '手机', width: 150}
                , {field: 'email', title: '邮箱', width: 150}
                , {field: 'role', title: '角色', width: 150}
                , {field: 'create_time', title: '加入时间', width: 200}
                , {field: 'status', title: '状态', width: 150, align: 'center', toolbar: '#status-bar'}
                , {title: '操作', toolbar: '#oprate-bar', minWidth: 200}
            ]]
        });


        table.on('tool(users-table)', function (obj) {
            var data = obj.data; //获得当前行数据
            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
            var tr = obj.tr; //获得当前行 tr 的DOM对象


            switch (layEvent) {
                case 'edit':
                    x_admin_show('编辑', );
                    break;
                case 'del':
                    break;
            }


            console.log(layEvent);
        });


        //状态开关监听
        form.on('switch(status)', function (data) {
            console.log(data.elem); //得到checkbox原始DOM对象
            console.log(data.elem.checked); //开关是否开启，true或者false
            console.log(data.value); //开关value值，也可以通过data.elem.value得到
            console.log(data.othis); //得到美化后的DOM对象
            console.log($(data.elem).data('id'));
        });

        //开始时间
        laydate.render({
            elem: '#start' //指定元素
        });

        //结束时间
        laydate.render({
            elem: '#end' //指定元素
        });

    });


    /*用户-删除*/
    function member_del(obj, id) {
        layer.confirm('确认要删除吗？', function (index) {
            //发异步删除数据
            $(obj).parents("tr").remove();
            layer.msg('已删除!', {icon: 1, time: 1000});
        });
    }


    function delAll(argument) {

        var data = tableCheck.getData();

        layer.confirm('确认要删除吗？' + data, function (index) {
            //捉到所有被选中的，发异步进行删除
            layer.msg('删除成功', {icon: 1});
            $(".layui-form-checked").not('.header').parents('tr').remove();
        });
    }
</script>
{/block}